import{x as E,k as P,h as x,l as T,o as v,g as F,b,d as $,t as C,f as k,a as m,u as t,Q as U,T as D,r as S,w as f,F as q,c as B}from"./app-D5M1G0zN.js";import{L as I,N as R,u as L}from"./NavigationDrawer-BRZQ9b0p.js";import{r as A,O as j,c as z,s as H,p as K,a as Q,b as X}from"./filepond-plugin-image-preview.esm-CI_uTiYr.js";import"./useConfirmMessage-MezlQya-.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";/*!
 * vue-filepond v7.0.4
 * A handy FilePond adapter component for Vue
 * 
 * Copyright (c) 2023 PQINA
 * https://pqina.nl/filepond
 * 
 * Licensed under the MIT license.
 */const G=["setOptions","on","off","onOnce","appendTo","insertAfter","insertBefore","isAttachedTo","replaceElement","restoreElement","destroy"],J=H(),W=d=>({string:String,boolean:Boolean,array:Array,function:Function,int:Number,serverapi:Object,object:Object})[d],_={},w=[],N=[];let Y={};const Z=(...d)=>{A(...d),w.length=0;for(const r in j){if(/^on/.test(r)){w.push(r);continue}let l=[String,W(j[r])];r=="labelFileProcessingError"&&l.push(Function),_[r]={type:l,default:void 0}}return{name:"FilePond",props:_,render(){const r=Object.entries({id:this.id,name:this.name,type:"file",class:this.className,required:this.required,multiple:this.allowMultiple,accept:this.acceptedFileTypes,capture:this.captureMethod}).reduce((l,[s,e])=>(e!==void 0&&(l[s]=e),l),{});return E("div",{class:{"filepond--wrapper":!0}},[E("input",r)])},created(){this.watchers=Object.keys(_).map(r=>this.$watch(r,l=>{this._pond&&(this._pond[r]=l)}))},mounted(){if(!J)return;this._element=this.$el.querySelector("input");const r=w.reduce((s,e)=>(s[e]=(...i)=>{this.$emit("input",this._pond?this._pond.getFiles():[]),this.$emit(e.substr(2),...i)},s),{}),l={};Object.keys(_).forEach(s=>{this[s]!==void 0&&(l[s]=this[s])}),this._pond=z(this._element,Object.assign({},Y,r,l)),Object.keys(this._pond).filter(s=>!G.includes(s)).forEach(s=>{this[s]=this._pond[s]}),N.push(this._pond)},beforeUnmount(){const{detached:r}=this.$options;if(!this.$el.offsetParent){r.call(this);return}const l=(e,i)=>{const c=((e[0]||{}).removedNodes||[])[0];!c||!c.contains(this.$el)||(i.disconnect(),r.call(this))};new MutationObserver(l).observe(document.documentElement,{childList:!0,subtree:!0})},detached(){if(this.watchers.forEach(l=>l()),!this._pond)return;this._pond.destroy();const r=N.indexOf(this._pond);r>=0&&N.splice(r,1),this._pond=null}}},ee={class:"mb-2"},te={key:0,class:"text-red-500"},oe={key:0},re={class:"text-red-500"},se={__name:"FileUploader",props:{modelValue:String,modelFiles:String,error:String,label:{type:String},name:String,placeholder:{type:String,default:"Drop or select file here"},required:Boolean,errorMessages:String},emits:["update:modelValue","update:modelFile","revert-file","remove-file"],setup(d,{expose:r,emit:l}){const s=d,e=l,i=P(null),h=x({set:u=>{e("update:modelValue",u)},get:()=>s.modelValue}),c=x({set:u=>{e("update:modelFile",u)},get:()=>s.modelFiles});T(()=>c.value,()=>{h.value&&(i.value=null,V())});const O=Z(X,Q,K),y=P(null),p=()=>{c.value?setTimeout(()=>{i.value=[{source:c.value,options:{type:"local",metadata:{poster:c.value}}}]},100):i.value=null},a=u=>{h.value=u},o=(u,n,M)=>{n(),e("remove-file")},g=(u,n,M)=>{n(),e("revert-file")},V=()=>{y.value.removeFiles()};return r({resetFilePond:V}),(u,n)=>(v(),F("div",ee,[b("label",null,[$(C(d.label),1),d.required?(v(),F("span",te,"*")):k("",!0)]),m(t(O),{name:"file",ref_key:"pond",ref:y,"label-idle":d.placeholder,"allow-multiple":!1,server:{timeout:7e3,process:{url:"/upload-file",method:"POST",headers:{"X-CSRF-TOKEN":t(U)().props.csrf_token},withCredentials:!1,onload:a,onerror:()=>{}},remove:o,revert:g},files:i.value,onInit:p,onRevert:g},null,8,["label-idle","server","files"]),d.errorMessages?(v(),F("div",oe,[b("small",re,C(d.errorMessages),1)])):k("",!0)]))}},le={class:"font-semibold text-lg"},ne={class:"mt-4"},ie={class:"flex gap-4 justify-end"},pe={__name:"DocumentForm",props:{modelValue:[Boolean,String],storeId:[String,Number],data:Object},emits:["update:modelValue","close","on-success"],setup(d,{emit:r}){const l=d,s=r;let e=D({id:null,name:l.storeId,category:null,description:null,file:null,user_id:null,file_url:null,remove_file:null});T(()=>l.data,a=>{e.id=a.id??null,e.name=a.name??null,e.user_id=a.user_id??null,e.category=a.category??null,e.description=a.description??null,e.file=a.file??null,e.file_url=a.file_url??null});const i=x({set:a=>{s("update:modelValue",a)},get:()=>l.modelValue}),{submitForm:h}=L(),c=async()=>{await h(e,`admin.documents.${e.id?"update":"store"}`,null,!0,!0).then(a=>{s("on-success"),e.reset(),i.value=!1})},O=()=>{e.reset(),s("close")},y=()=>{e.remove_file=!0};T(()=>i.value,()=>{i.value||e.reset()});const p=x(()=>e.user_id===U().props.auth.user.id&&e.id);return(a,o)=>{const g=S("VTextField"),V=S("VTextarea"),u=S("VBtn");return v(),F(q,null,[m(I,{show:t(e).processing},null,8,["show"]),m(R,{class:"z-50",onClose:O,modelValue:i.value,"onUpdate:modelValue":o[10]||(o[10]=n=>i.value=n),size:"400"},{header:f(()=>[b("p",le,C(`${t(e).id?"Update":"Create"} Document`),1)]),default:f(()=>[m(g,{color:"primary",label:"Name",disabled:!p.value,variant:"outlined",density:"comfortable",modelValue:t(e).name,"onUpdate:modelValue":[o[0]||(o[0]=n=>t(e).name=n),o[1]||(o[1]=n=>t(e).clearErrors("name"))],"error-messages":t(e).errors.name},null,8,["disabled","modelValue","error-messages"]),m(g,{color:"primary",label:"Category",disabled:!p.value,variant:"outlined",density:"comfortable",modelValue:t(e).category,"onUpdate:modelValue":[o[2]||(o[2]=n=>t(e).category=n),o[3]||(o[3]=n=>t(e).clearErrors("category"))],"error-messages":t(e).errors.category},null,8,["disabled","modelValue","error-messages"]),m(V,{color:"primary",label:"Description",variant:"outlined",disabled:!p.value,density:"comfortable",modelValue:t(e).description,"onUpdate:modelValue":[o[4]||(o[4]=n=>t(e).description=n),o[5]||(o[5]=n=>t(e).clearErrors("description"))],"error-messages":t(e).errors.description},null,8,["disabled","modelValue","error-messages"]),b("div",ne,[(v(),B(se,{id:`${t(e).id}-id`,key:`${t(e).id}-key`,ref:"image_uploader",modelValue:t(e).file,"onUpdate:modelValue":[o[6]||(o[6]=n=>t(e).file=n),o[7]||(o[7]=n=>t(e).clearErrors("file"))],disabled:!p.value,placeholder:"Drop or select document file here","model-files":t(e).file_url,onRemoveFile:y,"error-messages":t(e).errors.file},null,8,["id","modelValue","disabled","model-files","error-messages"]))])]),footer:f(()=>[b("div",ie,[m(u,{color:"error",onClick:o[8]||(o[8]=n=>i.value=!1)},{default:f(()=>[$(" Close ")]),_:1}),p.value?(v(),B(u,{key:0,onClick:o[9]||(o[9]=n=>t(e).reset())},{default:f(()=>[$(" Clear Fields ")]),_:1})):k("",!0),m(u,{variant:"flat",color:"primary",onClick:c},{default:f(()=>[$(C(t(e).id?"Update":"Submit"),1)]),_:1})])]),_:1},8,["modelValue"])],64)}}};export{pe as default};
