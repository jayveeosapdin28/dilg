import{s as I,x as Q,m as E,T as R,j as z,k as q,y as K,r as L,o as u,g as m,a as x,u as c,w as j,F,Q as T,Z,b as o,d as U,z as A,A as J,f as O,n as B,t as S,D as P}from"./app-My8rjfsu.js";import{_ as W}from"./AuthenticatedLayout-khQZS_JL.js";import"./useCrud-BtQ1hKPU.js";import X from"./ChatForm-D8SS3OIm.js";import{_ as Y}from"./PageHeading-B7I5pnNK.js";import{d as G}from"./dayjs.min-CplzuPa2.js";import"./useRole-BM8jtJZ0.js";import"./useConfirmMessage-E0_DeeMv.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./NavigationDrawer-B7i0DcYE.js";var H={exports:{}};(function(D,N){(function(f,p){D.exports=p()})(I,function(){return function(f,p,a){f=f||{};var h=p.prototype,$={future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};function y(e,n,g,s){return h.fromToBase(e,n,g,s)}a.en.relativeTime=$,h.fromToBase=function(e,n,g,s,r){for(var b,k,v,C=g.$locale().relativeTime||$,t=f.thresholds||[{l:"s",r:44,d:"second"},{l:"m",r:89},{l:"mm",r:44,d:"minute"},{l:"h",r:89},{l:"hh",r:21,d:"hour"},{l:"d",r:35},{l:"dd",r:25,d:"day"},{l:"M",r:45},{l:"MM",r:10,d:"month"},{l:"y",r:17},{l:"yy",d:"year"}],_=t.length,i=0;i<_;i+=1){var l=t[i];l.d&&(b=s?a(e).diff(g,l.d,!0):g.diff(e,l.d,!0));var d=(f.rounding||Math.round)(Math.abs(b));if(v=b>0,d<=l.r||!l.r){d<=1&&i>0&&(l=t[i-1]);var V=C[l.l];r&&(d=r(""+d)),k=typeof V=="string"?V.replace("%d",d):V(d,n,l.l,v);break}}if(n)return k;var M=v?C.future:C.past;return typeof M=="function"?M(k):M.replace("%s",k)},h.to=function(e,n){return y(e,n,this,!0)},h.from=function(e,n){return y(e,n,this)};var w=function(e){return e.$u?a.utc():a()};h.toNow=function(e){return this.to(w(this),e)},h.fromNow=function(e){return this.from(w(this),e)}}})})(H);var ee=H.exports;const te=Q(ee),se={class:"space-x-4"},oe=o("i",{class:"bi bi-plus mr-1"},null,-1),re={class:"h-full grid grid-cols-4 lg:grid-cols-5 mt-8 pb-24 gap-6"},ae={class:"bg-white rounded-lg border border-primary-600 shadow-lg h-full overflow-y-auto py-4 hidden lg:block"},le=["onClick"],ne=o("img",{src:"/img/default/default-user.png",class:"aspect-square w-10 rounded-full"},null,-1),ie={class:"mb-0 pb-0 leading-4 font-semibold"},de={key:1,class:"h-full max-h-full overflow-y-auto space-y-8 flex justify-center items-center text-slate-400 text-lg"},ue={class:"col-span-4 shadow-lg border rounded-lg h-full overflow-hidden flex flex-col gap-6 p-6"},me={class:"flex items-start gap-6"},ce={class:"py-2 px-4 shadow-lg rounded-lg bg-primary-100 max-w-xl"},fe={class:"text-slate-400"},pe={key:1,class:"h-full max-h-full overflow-y-auto space-y-8 flex justify-center items-center text-slate-400 text-lg"},he={key:2,class:"flex gap-6 h-16"},ge="Chat",Te={__name:"Index",setup(D){var g;G.extend(te);const N=E(()=>T().props.chats),f=E(()=>T().props.rooms),p=E(()=>T().props.room),a=R({message:null,room:(g=p.value)==null?void 0:g.uuid}),h=[{name:"Chat List",href:"#",current:!0}],$=z(null),y=z(!1),w=()=>{const s=$.value;s&&s.scroll({top:s.scrollHeight,behavior:"smooth"})};q(()=>{w()});const e=()=>{axios.post(route("admin.chats.store"),a).then(s=>{a.reset(),K(()=>{w()})})},n=s=>{P.get(route("admin.chats.show",s))};return q(()=>{var s;Echo.private(`chat.${(s=p.value)==null?void 0:s.id}`).listen("SentMessageEvent",r=>{N.value.push(r.chat),K(()=>{w()})})}),(s,r)=>{const b=L("VBtn"),k=L("VTextField");return u(),m(F,null,[x(c(Z),{title:"Chat"}),x(X,{modelValue:y.value,"onUpdate:modelValue":r[0]||(r[0]=v=>y.value=v)},null,8,["modelValue"]),x(W,{class:"flex flex-col gap-y-5"},{default:j(()=>{var v,C;return[x(Y,{title:ge,pages:h},{action:j(()=>[o("div",se,[x(b,{onClick:r[1]||(r[1]=t=>y.value=!0),variant:"outlined",color:"primary"},{default:j(()=>[oe,U(" New Message ")]),_:1})])]),_:1}),o("div",re,[o("div",ae,[(v=f.value)!=null&&v.length?(u(!0),m(F,{key:0},A(f.value,t=>{var _;return u(),m("div",{onClick:i=>n(t.uuid),class:B([{"!bg-primary-100 ":((_=p.value)==null?void 0:_.uuid)===t.uuid},"flex py-2 px-4 items-center gap-6 text-slate-400 hover:bg-primary-50 cursor-pointer"])},[ne,o("div",null,[o("p",ie,S(t.name),1)])],10,le)}),256)):(u(),m("div",de," Chat room is empty "))]),o("div",ue,[p.value?(u(),m("div",{key:0,ref_key:"messageContainer",ref:$,class:"h-full max-h-full overflow-y-auto space-y-8"},[(u(!0),m(F,null,A(N.value,t=>{var _,i,l,d,V,M;return u(),m("div",{class:B([{"justify-end ":t.user_id===((i=(_=c(T)().props.auth)==null?void 0:_.user)==null?void 0:i.id)},"flex items-start gap-6 px-4"])},[o("div",me,[o("img",{class:B([{" order-last":t.user_id===((d=(l=c(T)().props.auth)==null?void 0:l.user)==null?void 0:d.id)},"aspect-square w-8 rounded-full"]),src:"/img/default/default-user.png"},null,2),o("div",null,[o("div",ce,S(t.message),1),o("div",{class:B({" text-right":t.user_id===((M=(V=c(T)().props.auth)==null?void 0:V.user)==null?void 0:M.id)})},[o("small",fe,S(c(G)(t.created_at).fromNow()),1)],2)])])],2)}),256))],512)):(u(),m("div",pe," Select chat room ")),(C=N.value)!=null&&C.length?(u(),m("div",he,[x(k,{color:"primary",variant:"outlined",density:"comfortable",modelValue:c(a).message,"onUpdate:modelValue":[r[2]||(r[2]=t=>c(a).message=t),r[3]||(r[3]=t=>c(a).clearErrors("message"))],"error-messages":c(a).errors.message,onKeydown:J(e,["enter"])},null,8,["modelValue","error-messages"]),x(b,{onClick:e,variant:"tonal",color:"orange",size:"large",class:"h-full mt-2"},{default:j(()=>[U("Send")]),_:1})])):O("",!0)])])]}),_:1})],64)}}};export{Te as default};
